<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forum - Home</title>
    <link rel="stylesheet" href="main.css">
    <link rel="stylesheet" href="home.css">
</head>
<body>
    <header class="header">
        <a href="#" class="logo">Lucas</a>
    </header>

    <div class="stylebar"></div>

    <nav class="navbar">
        <ul>
            <li><a href="#">Home</a></li>
            <li><a href="#">About</a></li>
            <li><a href="#">Contact</a></li>
            <li><a href="#">Login</a></li>
        </ul>
    </nav>
        
    <div class="container">
        <div class="topcontainer">
            <h3>About Community</h3>
            <p>Welcome to our forum! This is a place to discuss anything and everything.</p>
        </div>

        <!-- Barre de recherche -->
        <div id="search-bar" style="margin: 20px 0;">
            <input type="text" id="searchInput" placeholder="Search threads..." onkeyup="rechercher()" />
        </div>

        <!-- Liste des posts -->
        <div class="posts" id="threadList">
            <div class="post">
                <div class="votes">
                    <div>▲</div>
                    <div>42</div>
                    <div>▼</div>
                </div>
                <div class="post-content">
                    <h2>Welcome to our new forum!</h2>
                    <div class="post-meta">
                        Posted by user123 • 2 hours ago • 15 comments
                    </div>
                    <button onclick="showReportForm(1, 1)">Signaler un problème</button>
                </div>
            </div>

            <!-- Ajoutez d'autres posts ici -->
        </div>
    </div>

    <div id="report-form" style="display:none;">
        <h3>Signaler un problème</h3>
        <form id="reportForm">
            <input type="hidden" id="userId">
            <input type="hidden" id="postId">
            <textarea id="reason" placeholder="Raison du signalement"></textarea>
            <button type="submit">Envoyer le signalement</button>
        </form>
    </div>

    <script>
        function showReportForm(userId, postId) {
            document.getElementById('userId').value = userId;
            document.getElementById('postId').value = postId;
            document.getElementById('report-form').style.display = 'block';
        }

        document.getElementById('reportForm').addEventListener('submit', async function(event) {
            event.preventDefault();
            const userId = document.getElementById('userId').value;
            const postId = document.getElementById('postId').value;
            const reason = document.getElementById('reason').value;

            if (!reason) {
                alert('Veuillez entrer une raison pour le signalement.');
                return;
            }

            const response = await fetch('/api/report', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ userId, postId, reason })
            });

            const result = await response.json();
            if (response.ok) {
                alert('Signalement envoyé avec succès');
                document.getElementById('report-form').style.display = 'none';
            } else {
                alert('Erreur lors de l\'envoi du signalement: ' + result.error);
            }
        });

        function rechercher() {
            const input = document.getElementById("searchInput").value.toLowerCase();
            const threads = document.querySelectorAll("#threadList .post");

            threads.forEach(thread => {
                const titre = thread.querySelector("h2").textContent.toLowerCase();
                thread.style.display = titre.includes(input) ? "" : "none";
            });
        }
    </script>
</body>
</html>
